
module(load="imuxsock"
    SysSock.Use="on"
    SysSock.Name="/run/systemd/journal/syslog"
    )

Module (path="builtin:ompipe")

module(load="imfile") 
template(name="auditlog" type="string" string="%msg%\n")

# File 1
input(type="imfile"
      File="/var/log/audit/audit.log"
      ruleset="auditlog"
      Tag="auditlog"
)

ruleset(name="auditlog"){
    action(type="ompipe" name="audit-pipe" Pipe="/var/log/audito-maldito/audit-pipe" template="auditlog")
}



template(name="sshd" type="string" string="%PROCID% %msg%\n")

:syslogtag, startswith, "sshd" action(type="ompipe" name="sshd-pipe" Pipe="/var/log/audito-maldito/sshd-pipe" template="sshd")


